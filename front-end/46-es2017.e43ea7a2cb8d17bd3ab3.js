"use strict";(self.webpackChunkmaterial_dashboard_pro_angular=self.webpackChunkmaterial_dashboard_pro_angular||[]).push([[46],{68046:function(e,t,o){o.r(t),o.d(t,{ReportingsModule:function(){return X}});var i=o(38583),r=o(39895),a=o(41335),n=o(3679),s=o(90670),l=o(47361),p=o(51440),d=o(7883),c=o(72458),u=o(79019),m=o(12664),h=o(54163),f=o(48080),g=o(64277),b=o(51903),v=o(87524),Z=o(40355),y=o(84934),A=o(39761),k=o(88002),C=o(64266),T=o(37453),x=o(44087),_=o(84487),R=o(37716),D=o(72541),q=o(79817),w=o(9709),S=o(37320),L=o(8985),N=o(65136),U=o(82327),F=o(91841);let I=(()=>{class e extends N.b{constructor(e,t){super(t),this.http=e}getBookingsReport(e){return this.http.post(U.V.getBookingsReport,e)}getEmptyReport(e){return this.http.post(U.V.getEmptyReport,e)}getConsoleReport(e){return this.http.post(U.V.getConsoleReport,e)}}return e.\u0275fac=function(t){return new(t||e)(R.LFG(F.eN),R.LFG(r.F0))},e.\u0275prov=R.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var O=o(98295),J=o(83166),P=o(43220),B=o(21554),E=o(67441);const M=["consoleReport"],z=["bookingReport"],Q=["emptyReport"];function V(e,t){if(1&e&&(R.TgZ(0,"mat-option",46),R._uU(1),R.qZA()),2&e){const e=t.$implicit;R.Q6J("value",e),R.xp6(1),R.hij(" ",e.name," ")}}function Y(e,t){if(1&e&&(R.TgZ(0,"mat-option",46),R._uU(1),R.qZA()),2&e){const e=t.$implicit;R.Q6J("value",e),R.xp6(1),R.hij(" ",e.name+" - Company "+e.company," ")}}function G(e,t){if(1&e&&(R.TgZ(0,"mat-option",46),R._uU(1),R.qZA()),2&e){const e=t.$implicit;R.Q6J("value",e),R.xp6(1),R.hij(" ",e.lastName+" "+e.firstName," ")}}function H(e,t){if(1&e&&(R.TgZ(0,"mat-option",46),R._uU(1),R.qZA()),2&e){const e=t.$implicit;R.Q6J("value",e.ID),R.xp6(1),R.hij(" ",e.value," ")}}function j(e,t){if(1&e&&(R.TgZ(0,"mat-option",46),R._uU(1),R.qZA()),2&e){const e=t.$implicit;R.Q6J("value",e.val),R.xp6(1),R.hij(" ",e.label," ")}}class W{}const $=[{path:"",children:[{path:"booking-report",component:(()=>{class e{constructor(e,t,o,i,r,a,s,l){this.customerService=e,this.buesinessPartnerService=t,this.userService=o,this.predataService=i,this.bookingService=r,this.reportService=a,this._dateFormatPipe=s,this.render=l,this.stage=1,this.displayedEmptyReportColumns=["cksnfile","name","containerNo","broker"],this.dateFilter=[{label:"Create date",val:"create_date"},{label:"Pickup Date",val:"pick_date"},{label:"ETA Border",val:"eta_border"},{label:"Clearance Date",val:"clearance"}],this.reportType="Booking_Report",this.invisbleLoading=!0,this.bookingStatusList=[],this.filterForm=new n.cw({customer:new n.NI,fromDate:new n.NI,toDate:new n.NI,bizPartner:new n.NI,userOperation:new n.NI,bookingStatus:new n.NI,selectionDate:new n.NI}),this.filterReportMode=new W}ngOnInit(){this.loadListCustomers(y.o.type_of_customer),this.loadBusinessPartners(),this.loadOperationUser(),this.getBookingStatusList()}ngAfterViewInit(){let e=new Date;e.setDate(e.getDate()-48),this.filterForm.get("fromDate").setValue(e),this.filterForm.get("toDate").setValue((new Date).toISOString()),this.filterForm.get("selectionDate").setValue(this.dateFilter[0].val)}onClick_filter(){this.invisbleLoading=!1,this.filterReportMode.fromDate=this._dateFormatPipe.transform(this.filterForm.get("fromDate").value),this.filterReportMode.toDate=this._dateFormatPipe.transform(this.filterForm.get("toDate").value),this.filterReportMode.bookingStatusID=this.filterForm.get("bookingStatus").value;let e=this.filterForm.get("bizPartner").value;this.filterReportMode.bizPartnerID=e.ID;let t=this.filterForm.get("userOperation").value;this.filterReportMode.userOperationID=t.ID;let o=this.filterForm.get("customer").value;this.filterReportMode.customerID=o.ID;let i=this.filterForm.get("bookingStatus").value;this.filterReportMode.bookingStatusID=i;let r=this.filterForm.get("selectionDate").value;this.filterReportMode.selectionDate=r,"Booking_Report"==this.reportType?(console.log(this.filterReportMode),this.bookingService.getBookingsReport(this.filterReportMode).subscribe(e=>{console.log(e.body),this.reportingDatas=e.body,this.buildHtmlTable(this.bookingReport,e.body),this.invisbleLoading=!0})):"Empty_Return_Report"==this.reportType?this.reportService.getEmptyReport(this.filterReportMode).subscribe(e=>{this.reportingEmptyDatas=e.body,this.buildHtmlTable(this.emptyReport,e.body),this.invisbleLoading=!0}):"Console_Report"==this.reportType&&this.reportService.getConsoleReport(this.filterReportMode).subscribe(e=>{this.reportingConsoleDatas=e.body,this.buildHtmlTable(this.consoleReport,this.reportingConsoleDatas),this.invisbleLoading=!0})}reportSelection(e){this.reportType=e}onClick_export(){let e,t="";"Booking_Report"==this.reportType?(t="Booking_Report",e=this.reportingDatas):"Empty_Return_Report"==this.reportType?(e=this.reportingEmptyDatas,t="Empty_Return_Report"):"Console_Report"==this.reportType&&(e=this.reportingConsoleDatas,t="Console_Report");const o=_.utils.json_to_sheet(e),i=_.utils.book_new();_.utils.book_append_sheet(i,o,"Sheet1");let r=t+this._dateFormatPipe.transform(new Date);_.writeFile(i,r+".xlsx")}displayCustomer(e){return e?e.name:void 0}onSelectionCustomerChanged(e){e.option.value&&(this.filterReportMode.customerID=e.option.value.ID)}onfilteredCustomers(e){return this.customersList.filter(t=>1==t.name.toLowerCase().includes(e.toLowerCase()))}loadListCustomers(e){this.customerService.getCustomerByType(e).subscribe(t=>{if(t.status==Z.G.success&&t.body.length>0&&e==y.o.type_of_customer)try{this.customersList=t.body;let e=new v.v;e.ID=y.o.allValue,e.name=y.o.all,this.customersList.unshift(e),this.filteredCustomer=this.filterForm.get("customer").valueChanges.pipe((0,A.O)(""),(0,k.U)(e=>"string"==typeof e?e:e?e.name:""),(0,k.U)(e=>e?this.onfilteredCustomers(e):this.customersList.slice())),this.filterForm.get("customer").setValue(this.customersList[0])}catch(o){console.log(o)}})}loadBusinessPartners(){this.buesinessPartnerService.getAllBusinessPartners().subscribe(e=>{if(e.status==Z.G.success&&e.body.length>0){this.businessPartnerList=e.body;let t=new C.u;t.ID=y.o.allValue,t.name=y.o.all,t.company=y.o.all,this.businessPartnerList.unshift(t),this.filteredbusinessPartner=this.filterForm.get("bizPartner").valueChanges.pipe((0,A.O)(""),(0,k.U)(e=>"string"==typeof e?e:e?e.name:""),(0,k.U)(e=>e?this.onfilteredBusinessPartner(e):this.businessPartnerList.slice())),this.filterForm.get("bizPartner").setValue(this.businessPartnerList[0])}})}onfilteredBusinessPartner(e){return this.businessPartnerList.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))}displayFnBizPartner(e){if(e)return e.ID==y.o.allValue?e.name+" - Companys ALL ":e.name+" - Companys "+e.company}onSelectionBizPartnerChanged(e){e.option.value&&(this.filterReportMode.bizPartnerID=e.option.value.ID)}onfilteredUserOperation(e){return this.userOperationList.filter(t=>(t.firstName.toLowerCase()+""+t.lastName.toLowerCase()).includes(e.toLowerCase()))}displayFNUserOperation(e){return null==e||e.firstName==y.o.all?y.o.all:e?e.lastName+" "+e.firstName:void 0}onSelectionUserOperationChanged(e){e.option.value&&(this.filterReportMode.userOperationID=e.option.value.ID)}loadOperationUser(){this.userService.getListUserOperation().subscribe(e=>{if(e.status==Z.G.success){this.userOperationList=e.body;let t=new T.T;t.ID=y.o.allValue,t.firstName=y.o.all,this.userOperationList.unshift(t),this.filteredUserOperation=this.filterForm.get("userOperation").valueChanges.pipe((0,A.O)(""),(0,k.U)(e=>"string"==typeof e?e:e?e.name:""),(0,k.U)(e=>e?this.onfilteredUserOperation(e):this.userOperationList.slice())),this.filterForm.get("userOperation").setValue(this.userOperationList[0])}})}getBookingStatusList(){this.predataService.getPreDefinedsByCriterial(y.o.booking_status).subscribe(e=>{if(console.log(e.body),e.status==Z.G.success&&e.body.length>0){this.bookingStatusList=e.body;let t=new x.p;t.ID=y.o.allValue,t.value=y.o.all,this.bookingStatusList.unshift(t),this.filterForm.get("bookingStatus").setValue(this.bookingStatusList[0].ID)}})}buildHtmlTable(e,t){var o=this.addAllColumnHeaders(e,t);try{var i=document.getElementById(e.nativeElement.id);i.removeChild(i.getElementsByTagName("tbody")[0])}catch(l){console.log(l)}for(var r=document.createElement("tbody"),a=0;a<t.length;a++){let e=document.createElement("tr");for(var n=0;n<o.length;n++){var s=t[a][o[n]];null==s&&(s="");let i=document.createElement("td");i.className="colwidth";let r=document.createTextNode(s);i.appendChild(r),e.appendChild(i)}r.appendChild(e)}this.render.appendChild(e.nativeElement,r)}addAllColumnHeaders(e,t){var o=[],i=document.createElement("thead"),r=document.createElement("tr");i.className="thead-dark";for(var a=0;a<t.length;a++){var n=t[a];for(var s in n)if(-1==o.indexOf(s)){o.push(s);let e=document.createElement("th"),t=document.createTextNode(s);e.appendChild(t),r.append(e)}}return i.appendChild(r),null!=e.nativeElement.tHead&&this.render.removeChild(e.nativeElement,e.nativeElement.tHead),this.render.appendChild(e.nativeElement,i),o}}return e.\u0275fac=function(t){return new(t||e)(R.Y36(D.v),R.Y36(q.Y),R.Y36(w.K),R.Y36(S.y),R.Y36(L.q),R.Y36(I),R.Y36(p.E),R.Y36(R.Qsj))},e.\u0275cmp=R.Xpm({type:e,selectors:[["app-booking-report"]],viewQuery:function(e,t){if(1&e&&(R.Gf(M,7),R.Gf(z,7),R.Gf(Q,7)),2&e){let e;R.iGM(e=R.CRH())&&(t.consoleReport=e.first),R.iGM(e=R.CRH())&&(t.bookingReport=e.first),R.iGM(e=R.CRH())&&(t.emptyReport=e.first)}},decls:92,vars:24,consts:[[1,"main-content"],[1,"container-fluid"],[1,"card"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-1"],[1,"col-md-3"],["matInput","","formControlName","fromDate","name","fromDate","placeholder","From date",3,"matDatepicker","focus"],["matSuffix","",3,"for"],["fromDatePciker",""],["matInput","","formControlName","toDate","name","toDate","placeholder","To Date",3,"matDatepicker","focus"],["toDatePicker",""],["type","text","formControlName","customer","placeholder","Customer","aria-label","Assignee","matInput","",3,"matAutocomplete"],[3,"displayWith","optionSelected"],["autoCustomer","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"example-full-width"],["type","text","placeholder","Biz Partner","formControlName","bizPartner","aria-label","bizPartner","matInput","",3,"matAutocomplete"],["autoCompleteBizPartner","matAutocomplete"],["type","text","placeholder","User Operation","formControlName","userOperation","aria-label","user operation","matInput","",3,"matAutocomplete"],["autoCompleteUserOperation","matAutocomplete"],["formControlName","bookingStatus"],["formControlName","selectionDate"],[1,"row","d-flex","justify-content-end"],[1,"btn","btn-info","btn-sm","btn",3,"click"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"card",3,"hidden"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-3"],[1,"nav-item",3,"click"],["id","pills-booking-tab","data-toggle","pill","href","#booking-tab","role","tab","aria-controls","pills-home","aria-selected","true",1,"nav-link","active"],["id","pills-empty-tab","data-toggle","pill","href","#empty-tab","role","tab","aria-controls","pills-empty","aria-selected","false",1,"nav-link"],["id","pills-console-tab","data-toggle","pill","href","#console-tab","role","tab","aria-controls","pills-empty","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","booking-tab","role","tabpanel","aria-labelledby","pills-home-tab",1,"tab-pane","fade","show","active"],["id","bookingReport",1,"table","%","!important;","table-responsive"],["bookingReport",""],["id","empty-tab","role","tabpanel","aria-labelledby","pills-empty-tab",1,"tab-pane","fade"],["id","emptyReport",1,"table","%","!important;","table-responsive"],["emptyReport",""],["id","console-tab","role","tabpanel","aria-labelledby","pills-console-tab",1,"tab-pane","fade"],["id","consoleReport",1,"table","%","!important;","table-responsive"],["consoleReport",""],[1,"loader",3,"hidden"],["viewBox","25 25 50 50",1,"circular"],["cx","50","cy","50","r","20","fill","none","stroke-width","2","stroke-miterlimit","10",1,"path"],[3,"value"]],template:function(e,t){if(1&e){const e=R.EpF();R.TgZ(0,"div",0),R.TgZ(1,"div",1),R.TgZ(2,"div",2),R.TgZ(3,"div",3),R.TgZ(4,"form",4),R.TgZ(5,"div",5),R._UZ(6,"div",6),R.TgZ(7,"div",7),R.TgZ(8,"mat-form-field"),R.TgZ(9,"input",8),R.NdJ("focus",function(){return R.CHM(e),R.MAs(12).open()}),R.qZA(),R._UZ(10,"mat-datepicker-toggle",9),R._UZ(11,"mat-datepicker",null,10),R.qZA(),R.qZA(),R.TgZ(13,"div",7),R.TgZ(14,"mat-form-field"),R.TgZ(15,"input",11),R.NdJ("focus",function(){return R.CHM(e),R.MAs(18).open()}),R.qZA(),R._UZ(16,"mat-datepicker-toggle",9),R._UZ(17,"mat-datepicker",null,12),R.qZA(),R.qZA(),R.TgZ(19,"div",7),R.TgZ(20,"mat-form-field"),R._UZ(21,"input",13),R.TgZ(22,"mat-autocomplete",14,15),R.NdJ("optionSelected",function(e){return t.onSelectionCustomerChanged(e)}),R.YNc(24,V,2,2,"mat-option",16),R.ALo(25,"async"),R.qZA(),R.qZA(),R.qZA(),R.qZA(),R.TgZ(26,"div",5),R._UZ(27,"div",6),R.TgZ(28,"div",7),R.TgZ(29,"mat-form-field",17),R._UZ(30,"input",18),R.TgZ(31,"mat-autocomplete",14,19),R.NdJ("optionSelected",function(e){return t.onSelectionBizPartnerChanged(e)}),R.YNc(33,Y,2,2,"mat-option",16),R.ALo(34,"async"),R.qZA(),R.qZA(),R.qZA(),R.TgZ(35,"div",7),R.TgZ(36,"mat-form-field",17),R._UZ(37,"input",20),R.TgZ(38,"mat-autocomplete",14,21),R.NdJ("optionSelected",function(e){return t.onSelectionUserOperationChanged(e)}),R.YNc(40,G,2,2,"mat-option",16),R.ALo(41,"async"),R.qZA(),R.qZA(),R.qZA(),R.TgZ(42,"div",7),R.TgZ(43,"mat-form-field"),R.TgZ(44,"mat-label"),R._uU(45,"Status"),R.qZA(),R.TgZ(46,"mat-select",22),R.YNc(47,H,2,2,"mat-option",16),R.qZA(),R.qZA(),R.qZA(),R.qZA(),R.TgZ(48,"div",5),R._UZ(49,"div",6),R.TgZ(50,"div",7),R.TgZ(51,"mat-form-field"),R.TgZ(52,"mat-label"),R._uU(53,"Selection Date"),R.qZA(),R.TgZ(54,"mat-select",23),R.YNc(55,j,2,2,"mat-option",16),R.qZA(),R.qZA(),R.qZA(),R.qZA(),R.TgZ(56,"div",24),R._UZ(57,"div",6),R.TgZ(58,"div",7),R.TgZ(59,"button",25),R.NdJ("click",function(){return t.onClick_filter()}),R._uU(60,"Filter"),R.qZA(),R.TgZ(61,"button",26),R.NdJ("click",function(){return t.onClick_export()}),R._uU(62,"Export"),R.qZA(),R.qZA(),R._UZ(63,"div",6),R.qZA(),R.qZA(),R.qZA(),R.qZA(),R.TgZ(64,"div",27),R.TgZ(65,"div",3),R.TgZ(66,"ul",28),R.TgZ(67,"li",29),R.NdJ("click",function(){return t.reportSelection("Booking_Report")}),R.TgZ(68,"a",30),R._uU(69,"Booking Report"),R.qZA(),R.qZA(),R.TgZ(70,"li",29),R.NdJ("click",function(){return t.reportSelection("Empty_Return_Report")}),R.TgZ(71,"a",31),R._uU(72,"Empty Report"),R.qZA(),R.qZA(),R.TgZ(73,"li",29),R.NdJ("click",function(){return t.reportSelection("Console_Report")}),R.TgZ(74,"a",32),R._uU(75,"Console Report"),R.qZA(),R.qZA(),R.qZA(),R.TgZ(76,"div",33),R.TgZ(77,"div",34),R.TgZ(78,"table",35,36),R._UZ(80,"tbody"),R.qZA(),R.qZA(),R.TgZ(81,"div",37),R.TgZ(82,"table",38,39),R._UZ(84,"tbody"),R.qZA(),R.qZA(),R.TgZ(85,"div",40),R.TgZ(86,"table",41,42),R._UZ(88,"tbody"),R.qZA(),R.qZA(),R.qZA(),R.qZA(),R.qZA(),R.TgZ(89,"div",43),R.O4$(),R.TgZ(90,"svg",44),R._UZ(91,"circle",45),R.qZA(),R.qZA(),R.qZA(),R.qZA()}if(2&e){const e=R.MAs(12),o=R.MAs(18),i=R.MAs(23),r=R.MAs(32),a=R.MAs(39);R.xp6(4),R.Q6J("formGroup",t.filterForm),R.xp6(5),R.Q6J("matDatepicker",e),R.xp6(1),R.Q6J("for",e),R.xp6(5),R.Q6J("matDatepicker",o),R.xp6(1),R.Q6J("for",o),R.xp6(5),R.Q6J("matAutocomplete",i),R.xp6(1),R.Q6J("displayWith",t.displayCustomer),R.xp6(2),R.Q6J("ngForOf",R.lcZ(25,18,t.filteredCustomer)),R.xp6(6),R.Q6J("matAutocomplete",r),R.xp6(1),R.Q6J("displayWith",t.displayFnBizPartner),R.xp6(2),R.Q6J("ngForOf",R.lcZ(34,20,t.filteredbusinessPartner)),R.xp6(4),R.Q6J("matAutocomplete",a),R.xp6(1),R.Q6J("displayWith",t.displayFNUserOperation),R.xp6(2),R.Q6J("ngForOf",R.lcZ(41,22,t.filteredUserOperation)),R.xp6(7),R.Q6J("ngForOf",t.bookingStatusList),R.xp6(8),R.Q6J("ngForOf",t.dateFilter),R.xp6(9),R.Q6J("hidden",!t.invisbleLoading),R.xp6(25),R.Q6J("hidden",t.invisbleLoading)}},directives:[n._Y,n.JL,n.sg,O.KE,J.Nt,n.Fj,P.hl,n.JJ,n.u,P.nW,O.R9,P.Mq,B.ZL,B.XC,i.sg,O.hX,E.gD,c.ey],pipes:[i.Ov],styles:["th{font-size:13px!important}.overlay{position:fixed;top:0;bottom:0;left:0;right:0;transition:opacity .5s;visibility:hidden;opacity:0}.overlay:target{visibility:visible;opacity:1}.popup{margin:150px auto;padding:20px;background:#fff;border-style:solid;border-color:#259ff5;border-radius:20px;width:30%;position:relative;transition:all 5s ease-in-out}.popup h2{margin-top:0;color:#333;font-family:Tahoma,Arial,sans-serif}.popup .close{position:absolute;top:20px;right:30px;transition:all .2s;font-size:30px;font-weight:bold;text-decoration:none;color:#333}.popup .close:hover{color:#06d85f}.popup .content{max-height:30%;overflow:auto}@media screen and (max-width: 700px){.box{width:70%}.popup{width:70%}}.customerName{margin-bottom:0}.place,phone{margin-bottom:0;color:gray;font-size:12px}.placeIconSize{font-size:14px!important}.phoneIconSize{font-size:14px!important}table{width:100%;overflow-y:scroll}.tbl-container{height:500px;overflow:auto}.colwidth{width:10px}.link{cursor:pointer}.link:hover{color:#00f}mat-cell{font-weight:400}.cdk-overlay-container{position:fixed;pointer-events:none;top:0;left:0;height:100%;width:100%;display:flex;position:absolute;z-index:9999999!important}.cdk-global-overlay-wrapper,.cdk-overlay-container{pointer-events:none;top:0;left:0;height:100%;width:100%;display:flex;position:absolute;z-index:9999999!important}.truncate-cell{max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.nav-pills .nav-item .nav-link{border-radius:10px}.nav-pills .nav-item .nav-link.active{color:#fff;background-color:#e91e63;box-shadow:0 4px 20px rgba(0,0,0,.141),0 7px 10px -5px rgba(156,39,176,.4);border-radius:10px}\n"],encapsulation:2}),e})()}]}];f.vI.add(b.fT,b.SZ);let X=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=R.oAB({type:e}),e.\u0275inj=R.cJS({providers:[p.E,{provide:c._A,useClass:u.B},{provide:c.sG,useValue:u.F}],imports:[[i.ez,r.Bz.forChild($),n.u5,n.UX,s.TW,l.vO,a.q,h.uH,d.B8,m.IJ,g.xC]]}),e})()}}]);